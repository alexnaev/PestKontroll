@using Microsoft.AspNetCore.Identity
@using PestKontroll.Models.Enums
@inject SignInManager<PKUser> SignInManager
@inject UserManager<PKUser> UserManager

@{
    PKUser pkUser = await UserManager.GetUserAsync(User);
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - PestKontroll</title>
    @* <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous"> *@
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <!-- STYLE CSS -->
    <link href="~/css/style.css" rel="stylesheet" />
    <link href="~/css/dark-style.css" rel="stylesheet" />
    <link href="~/css/transparent-style.css" rel="stylesheet">
    <link href="~/css/skin-modes.css" rel="stylesheet" />
    
    <!--- FONT-ICONS CSS -->
    <link href="~/css/icons.css" rel="stylesheet" />

    <!-- COLOR SKIN CSS -->
    <link id="theme" rel="stylesheet" type="text/css" media="all" href="~/css/colors/color1.css" />

</head>
<body class="app sidebar-mini ltr light-mode">

    <!-- GLOBAL-LOADER -->
    <div id="global-loader">
        <img src="~/img/loader.svg" class="loader-img" alt="Loader">
    </div>
    <!-- /GLOBAL-LOADER -->

    <div class="container-fluid overflow-hidden">
        <div class="row overflow-auto">
            <!-- app-Header -->
            <div class="col-12 app-header header sticky">
                <div class="container-fluid main-container">
                    <div class="d-flex">
                        <a aria-label="Hide Sidebar" class="app-sidebar__toggle" data-bs-toggle="sidebar" href="javascript:void(0)"></a>
                        <!-- sidebar-toggle-->
                        <a class="logo-horizontal " href="#">
                            <img src="~/images/brand/logo.png" class="header-brand-img desktop-logo" alt="logo">
                            <img src="~/images/brand/logo-3.png" class="header-brand-img light-logo1"
                                alt="logo">
                        </a>
                        <!-- LOGO -->
                        <div class="main-header-center ms-3 d-none d-lg-block">
                            <input type="text" class="form-control" id="typehead" placeholder="Search for results...">
                            <button class="btn px-0 pt-2"><i class="fe fe-search" aria-hidden="true"></i></button>
                        </div>
                        <div class="d-flex order-lg-2 ms-auto header-right-icons">
                            <!-- SEARCH -->
                            <button class="navbar-toggler navresponsive-toggler d-lg-none ms-auto" type="button"
                                data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent-4"
                                aria-controls="navbarSupportedContent-4" aria-expanded="false"
                                aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon fe fe-more-vertical"></span>
                            </button>
                            <div class="navbar navbar-collapse responsive-navbar p-0">
                                <div class="collapse navbar-collapse" id="navbarSupportedContent-4">
                                    <div class="d-flex order-lg-2">
                                        <div class="dropdown d-lg-none d-flex">
                                            <a href="javascript:void(0)" class="nav-link icon" data-bs-toggle="dropdown">
                                                <i class="fe fe-search"></i>
                                            </a>
                                            <div class="dropdown-menu header-search dropdown-menu-start">
                                                <div class="input-group w-100 p-2">
                                                    <input type="text" class="form-control" placeholder="Search....">
                                                    <div class="input-group-text btn btn-primary">
                                                        <i class="fa fa-search" aria-hidden="true"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- DARK/LIGHT MODE -->
                                        <div class="d-flex country">
                                            <a class="nav-link icon theme-layout nav-link-bg layout-setting">
                                                <span class="dark-layout"><i class="fe fe-moon"></i></span>
                                                <span class="light-layout"><i class="fe fe-sun"></i></span>
                                            </a>
                                        </div>
                                        <!-- DARK/LIGHT MODE END -->


                                        <partial name="_LoginPartial" />
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /app-Header -->

            @if (SignInManager.IsSignedIn(User))
            {
                <!--APP-SIDEBAR-->
            <div class="col-auto sticky">
                <div class="app-sidebar__overlay" data-bs-toggle="sidebar"></div>
                <div class="app-sidebar">
                    <div class="side-header">
                        <a class="header-brand1" asp-area="" asp-controller="Home" asp-action="Dashboard">
                            <img src="~/img/PestKontroll-logo-sm.png" class="header-brand-img desktop-logo" alt="logo">
                            <img src="~/img/PestKontroll-logo-sm.png" class="header-brand-img toggle-logo"
                                alt="logo">
                            <img src="~/img/PestKontroll-logo-sm.png" class="header-brand-img light-logo" alt="logo">
                            <img src="~/img/PestKontroll-logo-sm.png" class="header-brand-img light-logo1"
                                alt="logo">
                        </a>
                        <!-- LOGO -->
                    </div>
                    <div class="main-sidemenu">
                        <div class="slide-left disabled" id="slide-left"><svg xmlns="http://www.w3.org/2000/svg"
                                fill="#7b8191" width="24" height="24" viewBox="0 0 24 24">
                                <path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" />
                            </svg></div>
                        <ul class="side-menu">
                            <li class="sub-category">
                                <h3>Main</h3>
                            </li>
                            <li class="slide">
                                <a class="side-menu__item has-link" data-bs-toggle="slide" asp-area="" asp-controller="Home" asp-action="Dashboard"><i
                                        class="side-menu__icon fe fe-home"></i><span
                                        class="side-menu__label">Dashboard</span></a>
                            </li>
                            <li class="sub-category">
                                <h3>Bugtracker</h3>
                            </li>
                            <li class="slide">
                                <a class="side-menu__item" data-bs-toggle="slide" href="javascript:void(0)"><i
                                        class="side-menu__icon fe fe-slack"></i><span
                                        class="side-menu__label">Projects</span><i
                                        class="angle fe fe-chevron-right"></i></a>
                                <ul class="slide-menu">
                                    <li class="side-menu-label1"><a href="javascript:void(0)">Apps</a></li>
                                    <li><a asp-area="" asp-controller="Projects" asp-action="Create" class="slide-item"> New Project</a></li>
                                    <li><a asp-area="" asp-controller="Projects" asp-action="MyProjects" class="slide-item"> My Projects</a></li>
                                    <li><a asp-area="" asp-controller="Projects" asp-action="AllProjects" class="slide-item"> All Projects</a></li>
                                    <li><a asp-area="" asp-controller="Projects" asp-action="ArchivedProjects" class="slide-item"> Archived Projects</a></li>
                                    <li><a asp-area="" asp-controller="Projects" asp-action="UnassignedProjects" class="slide-item"> Unassigned Projects</a></li>
                                </ul>
                            </li>
                            <li class="slide">
                                <a class="side-menu__item" data-bs-toggle="slide" href="javascript:void(0)"><i
                                        class="side-menu__icon fe fe-package"></i><span
                                        class="side-menu__label">Tickets</span><i
                                        class="angle fe fe-chevron-right"></i></a>
                                <ul class="slide-menu mega-slide-menu">
                                    <li class="side-menu-label1"><a href="javascript:void(0)">Bootstrap</a></li>
                                    <div class="mega-menu">
                                        <div class="">
                                            <ul>
                                                <li><a asp-area="" asp-controller="Tickets" asp-action="Create" class="slide-item"> New Ticket</a></li>
                                                <li><a asp-area="" asp-controller="Tickets" asp-action="MyTickets" class="slide-item"> My Tickets</a></li>
                                                <li><a asp-area="" asp-controller="Tickets" asp-action="AllTickets" class="slide-item"> All Tickets</a></li>
                                                <li><a asp-area="" asp-controller="Tickets" asp-action="ArchivedTickets" class="slide-item"> Archived Tickets</a></li>
                                                <li><a asp-area="" asp-controller="Tickets" asp-action="UnassignedTickets" class="slide-item"> Unassigned Tickets</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </ul>
                            </li>
                            <li>
                                <a class="side-menu__item has-link" asp-area="" asp-controller="Companies" asp-action="Details" asp-route-id="@pkUser.CompanyId"><i
                                        class="side-menu__icon fe fe-zap"></i><span
                                        class="side-menu__label">Company</span></a>
                            </li>
                        </ul>
                        <div class="slide-right" id="slide-right"><svg xmlns="http://www.w3.org/2000/svg" fill="#7b8191"
                                width="24" height="24" viewBox="0 0 24 24">
                                <path d="M10.707 17.707 16.414 12l-5.707-5.707-1.414 1.414L13.586 12l-4.293 4.293z" />
                            </svg></div>
                    </div>
                </div>
                <!--/APP-SIDEBAR-->
            </div>
            }
            @* <div class="col-12 col-sm-3 col-xl-2 px-sm-2 px-0 bg-dark d-flex sticky-top">
                <div class="d-flex flex-sm-column flex-row flex-grow-1 align-items-center align-items-sm-start px-3 pt-2 text-white">
                    <a href="/" class="d-flex align-items-center pb-sm-3 mb-md-0 me-md-auto text-white text-decoration-none">
                        <span class="fs-5"><span class="d-none d-sm-inline">PestKontroll</span></span>
                    </a>
                    <partial name="_LoginPartial" />

                    @if (SignInManager.IsSignedIn(User))
                    {
                        <ul class="nav nav-pills flex-sm-column flex-row flex-nowrap flex-shrink-1 flex-sm-grow-0 flex-grow-1 mb-sm-auto mb-0 justify-content-center align-items-center align-items-sm-start" id="menu">
                            <li class="nav-item">
                                <a asp-area="" asp-controller="Home" asp-action="Dashboard" class="nav-link px-sm-0 px-2">
                                    <i class="fs-5 bi-house"></i><span class="ms-1 d-none d-sm-inline">Home</span>
                                </a>
                            </li>
                            <li>
                                <a asp-area="" asp-controller="Companies" asp-action="Index" class="nav-link px-sm-0 px-2">
                                    <i class="fs-5 bi-building"></i><span class="ms-1 d-none d-sm-inline">Company</span>
                                </a>
                            </li>
                            <li class="dropdown">
                                <a asp-area="" asp-controller="Projects" asp-action="Index" class="nav-link dropdown-toggle px-sm-0 px-2" id="dropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="fs-5 bi-file-earmark-ppt"></i><span class="ms-1 d-none d-sm-inline">Projects</span>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdown">
                                    @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.ProjectManager)))
                                    {
                                        <li><a class="dropdown-item" asp-area="" asp-controller="Projects" asp-action="Create">New project...</a></li>
                                    }
                                    @if (!User.IsInRole(nameof(Roles.Admin)))
                                    {
                                        <li><a class="dropdown-item" asp-area="" asp-controller="Projects" asp-action="MyProjects">My Projects</a></li>
                                    }
                                    <li><a class="dropdown-item" asp-area="" asp-controller="Projects" asp-action="AllProjects">All Projects</a></li>
                                    <li><a class="dropdown-item" asp-area="" asp-controller="Projects" asp-action="ArchivedProjects">Archived Projects</a></li>
                                    @if (User.IsInRole(nameof(Roles.Admin)))
                                    {
                                        <li><a class="dropdown-item" asp-area="" asp-controller="Projects" asp-action="UnassignedProjects">Unassigned Projects</a></li>
                                    }
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a asp-area="" asp-controller="Tickets" asp-action="Index" class="nav-link dropdown-toggle px-sm-0 px-2" id="dropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="fs-5 bi-file-earmark-font"></i><span class="ms-1 d-none d-sm-inline">Tickets</span>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdown">
                                    <li><a class="dropdown-item" asp-area="" asp-controller="Tickets" asp-action="Create">New ticket...</a></li>
                                    @if (!User.IsInRole(nameof(Roles.Admin)))
                                    {
                                        <li><a class="dropdown-item" asp-area="" asp-controller="Tickets" asp-action="MyTickets">My Tickets</a></li>
                                    }
                                    <li><a class="dropdown-item" asp-area="" asp-controller="Tickets" asp-action="AllTickets">All Tickets</a></li>
                                    <li><a class="dropdown-item" asp-area="" asp-controller="Tickets" asp-action="ArchivedTickets">Archived Tickets</a></li>
                                    @if (User.IsInRole(nameof(Roles.Admin)) || User.IsInRole(nameof(Roles.ProjectManager)))
                                    {
                                        <li><a class="dropdown-item" asp-area="" asp-controller="Tickets" asp-action="UnassignedTickets">Unassigned Tickets</a></li>
                                    }
                                </ul>
                            </li>
                            <li>
                                <a asp-area="" asp-controller="Notifications" asp-action="Index" class="nav-link px-sm-0 px-2">
                                    <i class="fs-5 bi-mailbox2"></i><span class="ms-1 d-none d-sm-inline">Notifications</span>
                                </a>
                            </li>
                        </ul>
                    }
                </div>
            </div> *@
            <div class="col d-flex flex-column h-100">
                <main class="main-content app-content mt-0">
                    @RenderBody()
                </main>
                <footer class="row bg-light py-4 mt-auto">
                    <div class="container">
                        &copy; 2023 - PestKontroll - <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
                    </div>
                </footer>
            </div>
        </div>
    </div>

    <!-- JQUERY -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <!-- BOOTSTRAP JS -->
    <script src="~/plugins/bootstrap/js/popper.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- COUNTERS JS-->
    <script src="~/plugins/counters/counterup.min.js"></script>
    <script src="~/plugins/counters/waypoints.min.js"></script>
    <script src="~/plugins/counters/counters-1.js"></script>

    <!-- SPARKLINE JS-->
    <script src="~/js/jquery.sparkline.min.js"></script>

    <!-- Sticky js -->
    <script src="~/js/sticky.js"></script>

    <!-- CHART-CIRCLE JS-->
    <script src="~/js/circle-progress.min.js"></script>

    <!-- PIETY CHART JS-->
    <script src="~/plugins/peitychart/jquery.peity.min.js"></script>
    <script src="~/plugins/peitychart/peitychart.init.js"></script>

    <!-- SIDEBAR JS -->
    <script src="~/plugins/sidebar/sidebar.js"></script>

    <!-- Perfect SCROLLBAR JS-->
    <script src="~/plugins/p-scroll/perfect-scrollbar.js"></script>
    <script src="~/plugins/p-scroll/pscroll.js"></script>
    <script src="~/plugins/p-scroll/pscroll-1.js"></script>

    <!-- INTERNAL CHARTJS CHART JS-->
    <script src="~/plugins/chart/Chart.bundle.js"></script>
    <script src="~/plugins/chart/rounded-barchart.js"></script>
    <script src="~/plugins/chart/utils.js"></script>

    <!-- INTERNAL SELECT2 JS -->
    <script src="~/plugins/select2/select2.full.min.js"></script>

    <!-- INTERNAL Data tables js-->
    <script src="~/plugins/datatable/js/jquery.dataTables.min.js"></script>
    <script src="~/plugins/datatable/js/dataTables.bootstrap5.js"></script>
    <script src="~/plugins/datatable/dataTables.responsive.min.js"></script>

    <!-- INTERNAL APEXCHART JS -->
    <script src="~/js/apexcharts.js"></script>
    <script src="~/plugins/apexchart/irregular-data-series.js"></script>

    <!-- INTERNAL Flot JS -->
    <script src="~/plugins/flot/jquery.flot.js"></script>
    <script src="~/plugins/flot/jquery.flot.fillbetween.js"></script>
    <script src="~/plugins/flot/chart.flot.sampledata.js"></script>
    <script src="~/plugins/flot/dashboard.sampledata.js"></script>

    <!-- INTERNAL Vector js -->
    <script src="~/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
    <script src="~/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

    <!-- SIDE-MENU JS-->
    <script src="~/plugins/sidemenu/sidemenu.js"></script>

	<!-- TypeHead js -->
	<script src="~/plugins/bootstrap5-typehead/autocomplete.js"></script>
    <script src="~/js/typehead.js"></script>

    <!-- INTERNAL INDEX JS -->
    <script src="~/js/index1.js"></script>

    <!-- Color Theme js -->
    <script src="~/js/themeColors.js"></script>

    <!-- CUSTOM JS -->
    <script src="~/js/custom.js"></script>

    @* <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script> *@
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>